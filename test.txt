.editor-wrapper {
  background: #d6d6d6;
  padding: 30px;
}

.page {
  width: 210mm;
  height: 297mm;
  margin: 15px auto;
  background: white;
  box-shadow: 0 0 8px rgba(0,0,0,0.25);
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
}

/* HEADER */
.page .header {
  height: 20mm;
  padding: 5mm 20mm;
  border-bottom: 1px solid #ccc;
  font-size: 12px;
}

/* CONTENT */
.page .content {
  height: calc(297mm - 40mm);
  padding: 10mm 20mm;
  overflow: hidden;
}

/* FOOTER */
.page .footer {
  height: 20mm;
  padding: 5mm 20mm;
  border-top: 1px solid #ccc;
  font-size: 12px;
  position: absolute;
  bottom: 0;
  width: 100%;
  text-align: center;
}

@media print {
  body {
    background: none;
  }
  .page {
    box-shadow: none;
    margin: 0;
    page-break-after: always;
  }
}


<div class="editor-wrapper">
  <editor
    apiKey="no-api-key"
    [init]="editorInit"
    (onInit)="onEditorInit($event)">
  </editor>

  <div style="text-align:center; margin-top:20px;">
    <button (click)="exportPDF()">Export PDF</button>
    <button (click)="exportDOCX()">Export DOCX</button>
  </div>
</div>


import { Component } from '@angular/core';
import html2pdf from 'html2pdf.js';
import * as htmlDocx from 'html-docx-js/dist/html-docx';

@Component({
  selector: 'app-home',
  templateUrl: './home.component.html'
})
export class HomeComponent {

  private editor: any;
  private pageCount = 1;

  editorInit = {
    height: '100%',
    menubar: false,
    plugins: 'lists table',
    toolbar: 'undo redo | bold italic | bullist numlist',
    content_style: `
      body { background:#d6d6d6; margin:0; }
      .content:focus { outline:none; }
    `,
    setup: (editor: any) => {
      editor.on('input keyup paste', () => {
        setTimeout(() => this.handlePaging(editor), 0);
      });
    }
  };

  onEditorInit(e: any) {
    this.editor = e.editor;
    this.editor.setContent(this.createPage(1));
  }

  createPage(pageNo: number) {
    return `
      <div class="page">
        <div class="header">Company Name â€“ Confidential</div>
        <div class="content" contenteditable="true"><p></p></div>
        <div class="footer">Page ${pageNo}</div>
      </div>
    `;
  }

  handlePaging(editor: any) {
    const pages = editor.getBody().querySelectorAll('.page');
    this.pageCount = pages.length;

    pages.forEach((page: HTMLElement, index: number) => {
      const content = page.querySelector('.content') as HTMLElement;
      const footer = page.querySelector('.footer') as HTMLElement;

      footer.innerText = `Page ${index + 1}`;

      // â›” Stop typing if overflow
      while (content.scrollHeight > content.clientHeight) {
        const lastPara = content.lastElementChild as HTMLElement;
        if (!lastPara) break;

        let nextPage = page.nextElementSibling as HTMLElement;
        if (!nextPage) {
          page.insertAdjacentHTML('afterend', this.createPage(++this.pageCount));
          nextPage = page.nextElementSibling as HTMLElement;
        }

        const nextContent = nextPage.querySelector('.content')!;
        nextContent.prepend(lastPara);
      }
    });
  }

  // ðŸ“„ PDF EXPORT
  exportPDF() {
    const el = document.querySelector('.editor-wrapper') as HTMLElement;
    html2pdf().from(el).save('document.pdf');
  }

  // ðŸ“„ DOCX EXPORT
  exportDOCX() {
    const html = this.editor.getContent();
    const blob = htmlDocx.asBlob(html);
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'document.docx';
    link.click();
  }
}

