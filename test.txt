
downloadAsWord() {
  const contentString = this.htmlContent;

  const fullHtml = `
  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="UTF-8">
      <style>
        body { font-family: Arial, sans-serif; font-size: 14px; }
        h1 { color: darkblue; }
      </style>
    </head>
    <body>${contentString}</body>
  </html>
  `;

  console.log('Full HTML:', fullHtml);

  try {
    const HTMLDocxJs = (HTMLDocx as any).default || HTMLDocx;
    const docxBlob = HTMLDocxJs.asBlob(fullHtml);

    console.log('docxBlob:', docxBlob);

    if (!(docxBlob instanceof Blob)) {
      console.error('Failed to create a valid Blob object.');
      return;
    }

    FileSaver.saveAs(docxBlob, 'template.docx');
  } catch (err) {
    console.error('Error creating DOCX:', err);
  }
}
